!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.i18nextLocalStorageBackend=e()}(this,function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(){return{prefix:"i18next_res_",expirationTime:6048e5,versions:{},store:window.localStorage}}var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function(){function e(n){t(this,e),this.store=n.store}return i(e,[{key:"setItem",value:function(t,e){if(this.store)try{this.store.setItem(t,e)}catch(t){}}},{key:"getItem",value:function(t,e){if(this.store)try{return this.store.getItem(t,e)}catch(t){}}}]),e}(),r=function(){function r(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t(this,r),this.init(e,n),this.type="backend"}return i(r,[{key:"init",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.services=t,this.options=n({},e(),this.options,i),this.storage=new o(this.options)}},{key:"read",value:function(t,e,n){var i=(new Date).getTime();if(!this.storage.store)return n(null,null);var o=this.storage.getItem(""+this.options.prefix+t+"-"+e);return o&&(o=JSON.parse(o),o.i18nStamp&&o.i18nStamp+this.options.expirationTime>i&&this.options.versions[t]===o.i18nVersion)?(delete o.i18nVersion,delete o.i18nStamp,n(null,o)):n(null,null)}},{key:"save",value:function(t,e,n){this.storage.store&&(n.i18nStamp=(new Date).getTime(),this.options.versions[t]&&(n.i18nVersion=this.options.versions[t]),this.storage.setItem(""+this.options.prefix+t+"-"+e,JSON.stringify(n)))}}]),r}();return r.type="backend",r});
